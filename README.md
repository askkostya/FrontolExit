# Скрипт выхода из программы Frontol 5-6 x

Скрипт для корректного завершения работы программы Frontol

## Основные возможности
- Определение в каком режиме сейчас находится Frontol (Регистрация, Супервизор)
- Вход под пользователем у которого есть права на (Выход в ОС/Перезагрузка компьютера)


## Настройка
1. Поместить файл inifrexit.ini в каталог со скриптом. 
ВНИМАНИЕ. Кодировка файла должна быть win-1251
2. Добавить файл frontexit.py в планировщик windows
Для выполнения команд из внешнего скрипта могут потребоваться права администратора
Если скрипт запускается вручную (для теста) убедитесь что фокус окна на приложении Фронтол

### Описание настроек файла inifrexit.ini
####FrontolPath = C:\Program Files (x86)\ATOL\Frontol6\BIN\Frontol.exe
Путь к файлу запуска программы Фронтол
####ExternalScriptPath=C:\zabbix\scripts\frpostexit.cmd
Путь к файлу внешнего скрипта который может быть запущен после того как будет осуществлен выход из Фронтол.
Если параметр RunExternalScript=0, то данный параметр будет проигнорирован
####ExitKey={ESC}
Клавиатурная комбинация назначенная на функцию Дополнительные \ Отмена (Выход)
####KeyExitOS={F2}
Клавиатурная комбинация назначенная на функцию Системные \ Выход в ОС. Если в данный параметр
внести комбинацию соответствующую функции Системные \ Перезагрузить кассу, то компьютер
перезагрузится средствами Фронтол и параметр RunExternalScript и ExternalScriptPath использоваться не будут
####LogOutKey={F1}
Клавиатурная комбинация назначенная на функцию Системные \ Завершение сеанса
####ApplicationTitle=Frontol v.
Заголовок окна. Если в файл frontol.ini в секцию [POS] не добавлялся параметр ApplicationTitle,
оставьте данную настройку по умолчанию. 
####ExitUser=Товаровед
Пользователь у которого есть права на (Выход в ОС/Перезагрузка)
####ExitUserPassword=123456
Пароль пользователя
####RunExternalScript=1
Запускать внешний скрипт после выхода из Фронтол


